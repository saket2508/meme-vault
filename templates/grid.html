{{define "grid"}}
{{range .}}
<div class="bg-white border rounded-lg shadow-md p-4" id="media-{{.ID}}"
     {{if eq .ProcessingStatus "processing"}}
     hx-get="/media/{{.ID}}/status"
     hx-trigger="load, every 2s"
     hx-target="#media-{{.ID}}"
     hx-swap="outerHTML"
     {{end}}>
    {{if eq .ProcessingStatus "processing"}}
    <div class="w-full h-48 bg-gray-200 rounded flex items-center justify-center">
        <div class="text-center">
            <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"></div>
            <p class="mt-2 text-sm text-gray-600">Processing...</p>
        </div>
    </div>
    {{else}}
    <img src="/{{.Thumb.String}}" alt="thumbnail" class="w-full h-48 object-cover rounded">
    {{end}}
    <div class="mt-2">
        <div id="tags-{{.ID}}" class="tags text-sm text-gray-600">{{.Tags}}</div>
        {{if eq .ProcessingStatus "completed"}}
        <details class="mt-2">
            <summary class="cursor-pointer text-blue-600">OCR Text</summary>
            <p class="mt-1 text-sm">{{.OcrText.String}}</p>
        </details>
        {{end}}
        <form hx-put="/media/{{.ID}}/tags" hx-swap="innerHTML" hx-target="#tags-{{.ID}}" class="mt-2 flex">
            <input type="text" name="tags" value="{{.Tags}}" class="border flex-1 p-1 text-sm">
            <button type="submit" class="bg-blue-500 text-white px-2 py-1 ml-2 text-sm">Update</button>
        </form>
    </div>
</div>
{{end}}
{{end}}